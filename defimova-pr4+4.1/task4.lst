GAS LISTING task4.S 			page 1


   1              	/**
   2              	 * –ü—Ä–æ–≥—Ä–∞–º–º–∞, —Å—É–º–º–∏—Ä—É—é—â–∞—è –æ–¥–Ω–æ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —á–∏—Å–ª–∞ (–∫–∞–∫ –ø–æ–ª–æ–
   3              	 *
   4              	 * Copyright (c) 2020, Dasha Efimova <dashulya0301178@gmail.com>
   5              	*/
   6              	
   7              	.include "my-macro"
   1              	/* 
   2              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
   3              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
   4              	 * 	- –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
   5              	 *
   6              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
   7              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              		movl $1, %eax 		    # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ exit –Ω–æ–º–µ—Ä 1
  11              		movl \ret_val, %ebx 	# –∫–æ–¥ –≤—ã—Ö–æ–¥–∞
  12              		int $0x80 		        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  13              	.endm  
  14              	
  15              	
  16              	/*
  17              	 * –ú–∞—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å–∏–
  18              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  19              	 * 	- –∞–¥—Ä–µ—Å –±—É—Ñ—Ñ–µ—Ä–∞ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è —Å–∏–º–≤–æ–ª–∞
  20              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  21              	 *	- –≤ %eax –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
  22              	 *	- –ø–æ –∞–¥—Ä–µ—Å—É buf_addr - —Å—á–∏—Ç–∞–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª
  23              	 * 
  24              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  25              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 read'
  26              	*/
  27              	.macro Getchar buf_addr
  28              		movl $3, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ read
  29              		movl $0, %ebx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
  30              		movl \buf_addr, %ecx	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ (–æ–Ω –∂–µ - —Ñ–∞–∫—Ç–∏—á–µ—Å–∫
  31              		     			        # –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞)
  32              		movl $1, %edx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—è
  33              		int $0x80		    # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  34              	.endm
  35              	
  36              	/*
  37              	 * –ú–∞—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –≤ —Å—Ç–∞–Ω–¥
  38              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  39              	 * 	- –°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞.
  40              	 *
  41              	 * –ü—Ä–∏–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞:
  42              	 *	Puts "–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä–æ–∫–∏" 
  43              	 *
  44              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  45              	 *	- –≤—ã–≤–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª—ã –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫
  46              	 *	  –∞ —Ç–∞–∫–∂–µ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏
  47              	 *	
  48              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  49              	 * –°–º. —Ç–∞–∫–∂–µ 'man puts', 'man 2 write'
  50              	*/
GAS LISTING task4.S 			page 2


  51              	.macro Puts string #–í—ã–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ —Å—Ç—Ä–æ–∫–∏
  52              	.data
  53              	    str\@: 	.ascii "\string"  # —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è
  54              		
  55              	    strlen\@ = 	. - str\@           # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏
  56              	
  57              	.text
  58              		movl $4, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
  59              		movl $1, %ebx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞	
  60              		movl $str\@, %ecx	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏–º–≤–æ
  61              		movl $strlen\@, %edx 	# –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞
  62              		int $0x80		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  63              	.endm
  64              				
  65              	.macro Putsn string #–í—ã–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º —Å–∏–º–≤–æ–ª–∞
  66              	.data
  67              	    str\@: 	.ascii "\string\n"  
  68              	    strlen\@ = 	. - str\@           
  69              	.text
  70              		movl $4, %eax		
  71              		movl $1, %ebx			
  72              		movl $str\@, %ecx	
  73              		movl $strlen\@, %edx 	
  74              		int $0x80		
  75              	.endm
  76              	
  77              	.macro Putn # –í—ã–≤–æ–¥ —á–∏—Å–ª–∞: eax - —Å—É–º–º–∞, ebx - –æ—Å–Ω–æ–≤–∞–Ω–∏–µ
  78              	.bss
  79              		.lcomm buf1\@, 10
  80              	.data
  81              	mins\@: .short -1
  82              	
  83              	.text
  84              	place_numbers\@:            # –î–µ–ª–∏–º
  85              		movl $0, %edx        # –≥–æ—Ç–æ–≤–∏–º –¥–µ–ª–µ–Ω–∏–µ
  86              		idivw %bx            # –¥–µ–ª–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ, —á–∞—Å—Ç–Ω–æ–µ —É—Ö–æ–¥–∏—Ç –≤ %edx 
  87              		add $'0', %dl        # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞ –∫–æ–¥ 0, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–∏–º–≤–
  88              		movb %dl, buf1\@(%esi) # –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–∏–º–≤–æ–ª –≤ –±—É—Ñ–µ—Ä
  89              		inc %esi             # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞ 1, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Å–∏
  90              		cmp $0, %ax          # —á–∞—Å—Ç–Ω–æ–µ = 0?
  91              		je preinverted\@      # –î–ê - –≥–æ—Ç–æ–≤–∏–º—Å—è –∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É –±—É—Ñ–µ—Ä–∞ —Å —Å–∏–º–≤–æ
  92              		jmp place_numbers\@  # –ù–ï–¢ - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–µ–ª–∏—Ç—å
  93              	
  94              	preinverted\@:           #–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º—Å—è –∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É –±—É—Ñ–µ—Ä–∞ —Å —Ü–∏—Ñ—Ä–∞
  95              		movl %esi, %ecx      # –ø–æ–º–µ—â–∞–µ–º –≤ ecx –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä —Å—É–º–º—ã
  96              		dec %ecx             # —É–∫–∞–∑–∞—Ç—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ 
  97              		movl %esi, %eax      # –ø–æ–º–µ—â–∞–µ–º –≤ e–∞x –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ —Å—É–º–º—ã
  98              		movl $0, %edx
  99              		movl $2, %ebx        # –±—É–¥–µ–º —É–∑–Ω–∞–≤–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞–º –Ω—É–∂–
 100              		idivl %ebx           # –¥–µ–ª–∏–º, —á–∞—Å—Ç–Ω–æ–µ —É—Ö–æ–¥–∏—Ç –≤ %edx 
 101              		movl $0, %esi
 102              		jmp inverted\@        # –ø–µ—Ä–µ—Ö–æ–¥–∏–º –¥–ª—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –±—É—Ñ–µ—Ä–∞
 103              	
 104              	inverted\@:              # –†–∞–∑–≤–æ—Ä–æ—Ç –±—É—Ñ–µ—Ä–∞
 105              		cmp %eax, %esi       # –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –ø–æ–º–µ–Ω—è–ª–∏ –º–µ—Å—Ç–∞–º–∏? 
 106              		je put_out\@         # –î–ê - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤—ã–≤–æ–¥
 107              		movb buf1\@(%esi), %bl # –ø–æ–º–µ—â–∞–µ–º –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ –∫ %bl –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é %esi 
GAS LISTING task4.S 			page 3


 108              		movl %ecx, %edx      # –ø–æ–º–µ—â–∞–µ–º –≤ %edx –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π –±—É—Ñ–µ—Ä–∞
 109              		sub %esi, %edx       # —É–∑–Ω–∞–µ–º, –Ω–∞ –∫–∞–∫–æ–µ –º–µ—Å—Ç–æ –º–µ–Ω—è—Ç—å
 110              		# –¥–∞–ª–µ–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –æ–±–º–µ–Ω —Å–∏–º–≤–æ–ª–æ–≤ –º–µ—Å—Ç–∞–º–∏ 
 111              		movb buf1\@(%edx), %bh
 112              		movb %bl, buf1\@(%edx)
 113              		movb %bh , buf1\@(%esi)
 114              		inc %esi             # —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å–ª–
 115              		jmp inverted\@        # –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç –±—É—Ñ–µ—Ä–∞
 116              	
 117              	put_out\@: #–í—ã–≤–æ–¥
 118              		inc %ecx             # —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ 
 119              		movl $4, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
 120              		movl $1, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–
 121              		movl %ecx, %edx      # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏–º–
 122              		movl $buf1\@, %ecx   # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞
 123              		int $0x80            # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
 124              	.endm
 125              	
   8              	
   9              	.bss
  10              	    .lcomm buf, 10 # –±—É—Ñ–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤. –†
  11              	    .lcomm c, 1 # –±—É—Ñ–µ—Ä –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞. –†–∞–∑–º–µ—Ä - 1 
  12              	
  13              	.data # —Å–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  14              	      #—Å–æ–æ—Ç–≤. –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —è–∑—ã–∫–∞ C –∏ –∫–æ–º–º–µ–Ω—Ç.
  15 0000 0000     	result: .short 0   # –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—É–º–º—ã (—Ä–∞–∑–º–µ—Ä 2 –±–∞–π—Ç–∞)
  16 0002 0A00     	ten:    .word 10  # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–ª—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 10
  17 0004 0200     	two:	.word 2   # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–ª—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 2
  18 0006 0800     	eight:	.word 8	  # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–ª—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 8
  19              	
  20              	.text                # —Å–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ 
  21              	    .global _start   # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞
  22              	
  23              	_start:
  24 0000 29F6     	    sub %esi, %esi   # —É–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥—Ä–µ—Å–∞ –±–∞–π—Ç–∞ –≤ –±—É—Ñ–µ—Ä–µ —Å–∏–º–≤–æ–ª–æ–≤ 
  25              	
  26              	kbd_input:
  27              	  
  28              	        Getchar $c      # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–
  28 0002 B8030000 	>  movl $3,%eax
  28      00
  28 0007 BB000000 	>  movl $0,%ebx
  28      00
  28 000c B90A0000 	>  movl $c,%ecx
  28      00
  28              	>  
  28 0011 BA010000 	>  movl $1,%edx
  28      00
  28 0016 CD80     	>  int $0x80
  29 0018 83F800   	        cmpl $0, %eax   # –ö–æ–Ω–µ—Ü —Ñ–∞–π–ª - EOF (–≤–≤–µ–¥–µ–Ω–æ 0 —Å–∏–º–≤–æ–ª–æ–≤) ?
  30 001b 0F843C02 	        je stop         # –î–∞ - –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  30      0000
  31 0021 803D0A00 	        cmpb $'\n', c   # —ç—Ç–æ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ ?
  31      00000A
  32 0028 741F     	        je presum       # –î–ê - –ø—ã—Ç–∞–µ–º—Å—è –ø—Ä–∏–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–º–≤–æ–
  33 002a 803D0A00 	        cmpb $'9', c    # –∫–æ–¥ –±–æ–ª—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '9' ?
  33      000039
GAS LISTING task4.S 			page 4


  34 0031 77CF     	        ja kbd_input    # –î–ê - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –µ–≥–æ
  35 0033 803D0A00 	        cmpb $'0', c    # –∫–æ–¥ –º–µ–Ω—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '0' ?
  35      000030
  36 003a 72C6     	        jb kbd_input    # –î–ê - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –µ–≥–æ
  37 003c A00A0000 	        movb c, %al     # –∫–æ–¥ –∏–∑ —Å –ø–∏—à–µ–º –≤ al
  37      00
  38 0041 88860000 	        movb %al, buf(%esi)  # –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ al (–≤–≤–µ–¥–µ–Ω–Ω—ã–π —Å–∏–
  38      0000
  39              				                 # –∞–¥—Ä–µ—Å—É buf + esi (–±—É—Ñ–µ—Ä –¥–ª—è –≤–≤–æ–¥–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤)
  40 0047 EBB9     	        jmp kbd_input   # –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  41              			
  42              	presum:
  43 0049 BA000000 	        movl $0, %edx   # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä—ã –¥–ª—è —Å—É–º–º—ã
  43      00
  44 004e B9000000 	        movl $0, %ecx
  44      00
  45 0053 B8000000 	        movl $0, %eax
  45      00
  46 0058 EB00     	        jmp summation   # 
  47              	
  48              	summation:  
  49 005a 8A860000 		movb buf(%esi), %al	# –±–∞–π—Ç–æ–≤–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, –∏–∑ –±—É—Ñ–µ—Ä–∞ buf + esi –∑–∞–±–
  49      0000
  50 0060 83E830   		subl $48, %eax		# –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ —Ü–∏—Ñ—Ä—ã –≤ —Å–∞–º–æ —á–∏
  51 0063 EB00     	        jmp summ         # –î–ê - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–æ–∂–µ–Ω–∏–µ
  52              	
  53              	summ: 
  54 0065 668B1D00 	        movw result, %bx # –∫–æ–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç(—Å—É–º–º—É) –≤ ebx
  54      000000
  55 006c 6601C3   	        add %ax, %bx     # –ø—Ä–æ–±—É–µ–º —Å–ª–æ–∂–∏—Ç—å
  56 006f 0F82D001 	        jc error         # –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ, —Ç–æ –ø–µ—Ä–µ—Ö–æ–
  56      0000
  57 0075 66891D00 	        movw %bx, result # –ø–æ–ª—É—á–∏–≤—à—É—é—Å—è —Å—É–º–º—É –ø–µ—Ä–µ–Ω–æ—Å–∏–º –æ–±—Ä–∞—Ç–Ω–æ –≤
  57      000000
  58 007c EB00     	        jmp output       # –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤—ã–≤–æ–¥ —Å—É–º–º—ã
  59              	
  60              	output: 
  61 007e 66A10000 		mov result, %ax      # –ø–æ–º–µ—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç(—Å—É–º–º—É) –≤ eax
  61      0000
  62 0084 BB0A0000 		mov $10, %ebx        # –ø–æ–º–µ—â–∞–µ–º 10 –≤ ebx 
  62      00
  63              		Putn                 # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—É–º–º—ã –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é
  63              	> .bss
  63              	>  .lcomm buf11,10
  63              	> .data
  63 0008 FFFF     	> mins1:.short -1
  63              	> 
  63              	> .text
  63              	> place_numbers1:
  63 0089 BA000000 	>  movl $0,%edx
  63      00
  63 008e 66F7FB   	>  idivw %bx
  63 0091 80C230   	>  add $48,%dl
  63 0094 88961000 	>  movb %dl,buf11(%esi)
  63      0000
  63 009a 46       	>  inc %esi
  63 009b 6683F800 	>  cmp $0,%ax
GAS LISTING task4.S 			page 5


  63 009f 7402     	>  je preinverted1
  63 00a1 EBE6     	>  jmp place_numbers1
  63              	> 
  63              	> preinverted1:
  63 00a3 89F1     	>  movl %esi,%ecx
  63 00a5 49       	>  dec %ecx
  63 00a6 89F0     	>  movl %esi,%eax
  63 00a8 BA000000 	>  movl $0,%edx
  63      00
  63 00ad BB020000 	>  movl $2,%ebx
  63      00
  63 00b2 F7FB     	>  idivl %ebx
  63 00b4 BE000000 	>  movl $0,%esi
  63      00
  63 00b9 EB00     	>  jmp inverted1
  63              	> 
  63              	> inverted1:
  63 00bb 39C6     	>  cmp %eax,%esi
  63 00bd 741F     	>  je put_out1
  63 00bf 8A9E1000 	>  movb buf11(%esi),%bl
  63      0000
  63 00c5 89CA     	>  movl %ecx,%edx
  63 00c7 29F2     	>  sub %esi,%edx
  63              	>  
  63 00c9 8ABA1000 	>  movb buf11(%edx),%bh
  63      0000
  63 00cf 889A1000 	>  movb %bl,buf11(%edx)
  63      0000
  63 00d5 88BE1000 	>  movb %bh,buf11(%esi)
  63      0000
  63 00db 46       	>  inc %esi
  63 00dc EBDD     	>  jmp inverted1
  63              	> 
  63              	> put_out1:
  63 00de 41       	>  inc %ecx
  63 00df B8040000 	>  movl $4,%eax
  63      00
  63 00e4 BB010000 	>  movl $1,%ebx
  63      00
  63 00e9 89CA     	>  movl %ecx,%edx
  63 00eb B9100000 	>  movl $buf11,%ecx
  63      00
  63 00f0 CD80     	>  int $0x80
  64              		Puts " "             # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π 
  64              	> .data
  64 000a 20       	>  str2:.ascii " "
  64              	>  
  64              	>  strlen2 =. - str2
  64              	> 
  64              	> .text
  64 00f2 B8040000 	>  movl $4,%eax
  64      00
  64 00f7 BB010000 	>  movl $1,%ebx
  64      00
  64 00fc B90A0000 	>  movl $str2,%ecx
  64      00
  64 0101 BA010000 	>  movl $strlen2,%edx
GAS LISTING task4.S 			page 6


  64      00
  64 0106 CD80     	>  int $0x80
  65 0108 BE000000 	        movl $0, %esi        # –æ—á–∏—â–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä
  65      00
  66 010d C6860000 		movb $0, buf(%esi)   # –æ—á–∏—â–∞–µ–º –±—É—Ñ–µ—Ä
  66      000000
  67              	
  68 0114 66A10000 		mov result, %ax      # –ø–æ–º–µ—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç(—Å—É–º–º—É) –≤ eax
  68      0000
  69 011a BB020000 		mov $2, %ebx         # –ø–æ–º–µ—â–∞–µ–º 2 –≤ ebx
  69      00
  70              		Putn                 # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—É–º–º—ã –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é
  70              	> .bss
  70              	>  .lcomm buf13,10
  70              	> .data
  70 000b FFFF     	> mins3:.short -1
  70              	> 
  70              	> .text
  70              	> place_numbers3:
  70 011f BA000000 	>  movl $0,%edx
  70      00
  70 0124 66F7FB   	>  idivw %bx
  70 0127 80C230   	>  add $48,%dl
  70 012a 88962000 	>  movb %dl,buf13(%esi)
  70      0000
  70 0130 46       	>  inc %esi
  70 0131 6683F800 	>  cmp $0,%ax
  70 0135 7402     	>  je preinverted3
  70 0137 EBE6     	>  jmp place_numbers3
  70              	> 
  70              	> preinverted3:
  70 0139 89F1     	>  movl %esi,%ecx
  70 013b 49       	>  dec %ecx
  70 013c 89F0     	>  movl %esi,%eax
  70 013e BA000000 	>  movl $0,%edx
  70      00
  70 0143 BB020000 	>  movl $2,%ebx
  70      00
  70 0148 F7FB     	>  idivl %ebx
  70 014a BE000000 	>  movl $0,%esi
  70      00
  70 014f EB00     	>  jmp inverted3
  70              	> 
  70              	> inverted3:
  70 0151 39C6     	>  cmp %eax,%esi
  70 0153 741F     	>  je put_out3
  70 0155 8A9E2000 	>  movb buf13(%esi),%bl
  70      0000
  70 015b 89CA     	>  movl %ecx,%edx
  70 015d 29F2     	>  sub %esi,%edx
  70              	>  
  70 015f 8ABA2000 	>  movb buf13(%edx),%bh
  70      0000
  70 0165 889A2000 	>  movb %bl,buf13(%edx)
  70      0000
  70 016b 88BE2000 	>  movb %bh,buf13(%esi)
  70      0000
GAS LISTING task4.S 			page 7


  70 0171 46       	>  inc %esi
  70 0172 EBDD     	>  jmp inverted3
  70              	> 
  70              	> put_out3:
  70 0174 41       	>  inc %ecx
  70 0175 B8040000 	>  movl $4,%eax
  70      00
  70 017a BB010000 	>  movl $1,%ebx
  70      00
  70 017f 89CA     	>  movl %ecx,%edx
  70 0181 B9200000 	>  movl $buf13,%ecx
  70      00
  70 0186 CD80     	>  int $0x80
  71              		Puts " "             # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π 
  71              	> .data
  71 000d 20       	>  str4:.ascii " "
  71              	>  
  71              	>  strlen4 =. - str4
  71              	> 
  71              	> .text
  71 0188 B8040000 	>  movl $4,%eax
  71      00
  71 018d BB010000 	>  movl $1,%ebx
  71      00
  71 0192 B90D0000 	>  movl $str4,%ecx
  71      00
  71 0197 BA010000 	>  movl $strlen4,%edx
  71      00
  71 019c CD80     	>  int $0x80
  72 019e BE000000 	        movl $0, %esi        # –æ—á–∏—â–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä
  72      00
  73 01a3 C6860000 		movb $0, buf(%esi)   # –æ—á–∏—â–∞–µ–º –±—É—Ñ–µ—Ä
  73      000000
  74              	
  75 01aa 66A10000 		mov result, %ax      # –ø–æ–º–µ—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç(—Å—É–º–º—É) –≤ eax
  75      0000
  76 01b0 BB080000 		mov $8, %ebx         # –ø–æ–º–µ—â–∞–µ–º 8 –≤ ebx
  76      00
  77              		Putn                 # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—É–º–º—ã –ø–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é
  77              	> .bss
  77              	>  .lcomm buf15,10
  77              	> .data
  77 000e FFFF     	> mins5:.short -1
  77              	> 
  77              	> .text
  77              	> place_numbers5:
  77 01b5 BA000000 	>  movl $0,%edx
  77      00
  77 01ba 66F7FB   	>  idivw %bx
  77 01bd 80C230   	>  add $48,%dl
  77 01c0 88963000 	>  movb %dl,buf15(%esi)
  77      0000
  77 01c6 46       	>  inc %esi
  77 01c7 6683F800 	>  cmp $0,%ax
  77 01cb 7402     	>  je preinverted5
  77 01cd EBE6     	>  jmp place_numbers5
  77              	> 
GAS LISTING task4.S 			page 8


  77              	> preinverted5:
  77 01cf 89F1     	>  movl %esi,%ecx
  77 01d1 49       	>  dec %ecx
  77 01d2 89F0     	>  movl %esi,%eax
  77 01d4 BA000000 	>  movl $0,%edx
  77      00
  77 01d9 BB020000 	>  movl $2,%ebx
  77      00
  77 01de F7FB     	>  idivl %ebx
  77 01e0 BE000000 	>  movl $0,%esi
  77      00
  77 01e5 EB00     	>  jmp inverted5
  77              	> 
  77              	> inverted5:
  77 01e7 39C6     	>  cmp %eax,%esi
  77 01e9 741F     	>  je put_out5
  77 01eb 8A9E3000 	>  movb buf15(%esi),%bl
  77      0000
  77 01f1 89CA     	>  movl %ecx,%edx
  77 01f3 29F2     	>  sub %esi,%edx
  77              	>  
  77 01f5 8ABA3000 	>  movb buf15(%edx),%bh
  77      0000
  77 01fb 889A3000 	>  movb %bl,buf15(%edx)
  77      0000
  77 0201 88BE3000 	>  movb %bh,buf15(%esi)
  77      0000
  77 0207 46       	>  inc %esi
  77 0208 EBDD     	>  jmp inverted5
  77              	> 
  77              	> put_out5:
  77 020a 41       	>  inc %ecx
  77 020b B8040000 	>  movl $4,%eax
  77      00
  77 0210 BB010000 	>  movl $1,%ebx
  77      00
  77 0215 89CA     	>  movl %ecx,%edx
  77 0217 B9300000 	>  movl $buf15,%ecx
  77      00
  77 021c CD80     	>  int $0x80
  78              		Putsn                # –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ —Å —Å–∏–º–≤–æ–ª–æ–º –ø–µ—Ä–µ
  78              	> .data
  78 0010 0A       	>  str6:.ascii "\n"
  78              	>  strlen6 =. - str6
  78              	> .text
  78 021e B8040000 	>  movl $4,%eax
  78      00
  78 0223 BB010000 	>  movl $1,%ebx
  78      00
  78 0228 B9100000 	>  movl $str6,%ecx
  78      00
  78 022d BA010000 	>  movl $strlen6,%edx
  78      00
  78 0232 CD80     	>  int $0x80
  79 0234 BE000000 		movl $0, %esi        # –æ—á–∏—â–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä
  79      00
  80 0239 C6860000 		movb $0, buf(%esi)   # –æ—á–∏—â–∞–µ–º –±—É—Ñ–µ—Ä
GAS LISTING task4.S 			page 9


  80      000000
  81 0240 E9BDFDFF 		jmp kbd_input        # –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  81      FF
  82              	
  83              	error:
  84              		Puts "–°—É–º–º–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞. –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã" # —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø
  84              	> .data
  84 0011 D0A1D183 	>  str7:.ascii "–°—É–º–º–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞. –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã"
  84      D0BCD0BC 
  84      D0B020D0 
  84      BFD0B5D1 
  84      80D0B5D0 
  84              	>  
  84              	>  strlen7 =. - str7
  84              	> 
  84              	> .text
  84 0245 B8040000 	>  movl $4,%eax
  84      00
  84 024a BB010000 	>  movl $1,%ebx
  84      00
  84 024f B9110000 	>  movl $str7,%ecx
  84      00
  84 0254 BA400000 	>  movl $strlen7,%edx
  84      00
  84 0259 CD80     	>  int $0x80
  85 025b EB00     		jmp stop                                  # –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  86              	 
  87              	 
  88              	stop:
  89              	    Exit $0
  89 025d B8010000 	>  movl $1,%eax
  89      00
  89 0262 BB000000 	>  movl $0,%ebx
  89      00
  89 0267 CD80     	>  int $0x80
  90              	
  91              	.end
GAS LISTING task4.S 			page 10


DEFINED SYMBOLS
             task4.S:10     .bss:0000000000000000 buf
             task4.S:10     .bss:000000000000000a c
             task4.S:15     .data:0000000000000000 result
             task4.S:16     .data:0000000000000002 ten
             task4.S:17     .data:0000000000000004 two
             task4.S:18     .data:0000000000000006 eight
             task4.S:23     .text:0000000000000000 _start
             task4.S:26     .text:0000000000000002 kbd_input
             task4.S:88     .text:000000000000025d stop
             task4.S:42     .text:0000000000000049 presum
             task4.S:48     .text:000000000000005a summation
             task4.S:53     .text:0000000000000065 summ
             task4.S:83     .text:0000000000000245 error
             task4.S:60     .text:000000000000007e output
             task4.S:63     .bss:0000000000000010 buf11
             task4.S:63     .data:0000000000000008 mins1
             task4.S:63     .text:0000000000000089 place_numbers1
             task4.S:63     .text:00000000000000a3 preinverted1
             task4.S:63     .text:00000000000000bb inverted1
             task4.S:63     .text:00000000000000de put_out1
             task4.S:64     .data:000000000000000a str2
             task4.S:64     *ABS*:0000000000000001 strlen2
             task4.S:70     .bss:0000000000000020 buf13
             task4.S:70     .data:000000000000000b mins3
             task4.S:70     .text:000000000000011f place_numbers3
             task4.S:70     .text:0000000000000139 preinverted3
             task4.S:70     .text:0000000000000151 inverted3
             task4.S:70     .text:0000000000000174 put_out3
             task4.S:71     .data:000000000000000d str4
             task4.S:71     *ABS*:0000000000000001 strlen4
             task4.S:77     .bss:0000000000000030 buf15
             task4.S:77     .data:000000000000000e mins5
             task4.S:77     .text:00000000000001b5 place_numbers5
             task4.S:77     .text:00000000000001cf preinverted5
             task4.S:77     .text:00000000000001e7 inverted5
             task4.S:77     .text:000000000000020a put_out5
             task4.S:78     .data:0000000000000010 str6
             task4.S:78     *ABS*:0000000000000001 strlen6
             task4.S:84     .data:0000000000000011 str7
             task4.S:84     *ABS*:0000000000000040 strlen7

NO UNDEFINED SYMBOLS
