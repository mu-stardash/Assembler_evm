GAS LISTING task1.S 			page 1


   1              	/*
   2              	 * –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∑–∏—Ü–∏–π —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è 
   3              	 * —Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ 
   4              	 * 32-–±–∏—Ç–æ–≤–æ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞
   5              	
   6              	 * –ü–æ–≥—Ä–∞–º–º–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–µ task1.c
   7              	 
   8              	 * –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:  as -ahlsm=task1.lst --32 -gstabs+ -o task1.o task1.S
   9              	 *	
  10              	 * -ahlsm –∫–ª—é—á–∏ –ø–æ–ª–Ω–æ–≥–æ –ª–∏—Å—Ç–∏–Ω–≥–∞
  11              	 * task1.lst - –∏–º—è –¢–ï–ö–°–¢–û–í–û–ì–û —Ñ–∞–π–ª–∞ –ª–∏—Å—Ç–∏–Ω–≥–∞, –æ–ø–∏—Å—ã–≤–∞—é—â–µ–≥–æ 
  12              	 * —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
  13              	
  14              	 * --32 - –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 32 —Ä–∞–∑—Ä—è–¥–Ω—ã–µ –º–∞—à–∏–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã 
  15              	
  16              	 * -gstabs+ - –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–ª
  17              	
  18              	 * -o task1.o - –∑–∞–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ ( –¥–ª—è –∫–æ–º–∞–Ω–¥—ã as - 
  19              	 * –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ) —Ñ–∞–π–ª–∞
  20              	
  21              	 * -o –∫–ª—é—á –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ ( –¥–ª—è –∫–æ–º–∞–Ω–¥—ã as - 
  22              	 * –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ) —Ñ–∞–π–ª–∞
  23              	
  24              	 * task1.S -  –∏—Å—Ö–æ–¥–Ω—ã–π -  –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
  25              	 *
  26              	 * –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–µ–π: ld -melf_i386 -o task1-exe-S task1.o
  27              	
  28              	 * –ú–û–ñ–ù–û –ù–ï –ß–ò–¢–ê–¢–¨! –í –Ω–∞—à–µ–º –∫—É—Ä—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 
  29              	 *	            -melf_i386 
  30              	 *  -m<—ç–º—É–ª—è—Ü–∏—è ld> ld –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥ 
  31              	 *     –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.
  32              	 *     –ì–æ–≤–æ—Ä—è—Ç, —á—Ç–æ ld "—ç–º—É–ª–∏—Ä—É–µ—Ç" –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.	 
  33              	 *  –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã - "—ç–º—É–ª—è—Ü–∏–∏":
  34              	   
  35              	*	elf_x86_64
  36              	*	elf_i386
  37              	*	i386linux
  38              	*	elf_l1om
  39              	
  40              	 * -o task1-exe-S - –∑–∞–¥–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ  
  41              	 * (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã ld -  –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ) —Ñ–∞–π–ª–∞ 
  42              	
  43              	 * -o –∫–ª—é—á –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ  
  44              	 * (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã ld -  –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ) —Ñ–∞–π–ª–∞
  45              	
  46              	 * task1.o - –æ–±—ä–µ–∫—Ç–Ω—ã–π —Ñ–∞–π–ª (–≤—Ö–æ–¥–Ω–æ–π –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Å–≤—è–∑–µ–π ld)
  47              	
  48              	 * –ó–∞–ø—É—Å–∫ –æ—Ç–ª–∞–¥—á–∏–∫–∞: kdbg task1-exe-S 
  49              	 *
  50              	*/
  51              	 
  52              	.include "my-macro"  # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
   1              	/* –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã */
   2              	
   3              	.macro Finish
   4              	    movl $0, %ebx 	# first argument: exit code
   5              	    movl $1, %eax 	# sys_exit index
GAS LISTING task1.S 			page 2


   6              	    int  $0x80 		# kernel interrupt
   7              	.endm
   8              	
  53              	
  54              	    
  55              	.data 	# —Å–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  56              	#               —Å–æ–æ—Ç–≤. –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —è–∑—ã–∫–∞ C –∏ –∫–æ–º–º–µ–Ω—Ç.
  57 0000 29090000 	n: 	.long 2345      # int n = 2345; —á–∏—Å–ª–æ
  58 0004 00000000 	length: .long 0         # int length =0; —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  59 0008 0A000000 	ten: 	.long 10        # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –Ø–í–ù–û 
  60              	                        # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C  
  61              	
  62              	.text # —Å–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ 
  63              	
  64              	.global _start 	# —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞
  65              	
  66              	_start: 	
  67 0000 90       		nop             # –ø—É—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - no operation
  68              	
  69              	# –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å –æ—Ç–ª–∞–¥—á–∏–∫—É –∫–æ–Ω—Ç—Ä. —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –Ω
  70              	# —Å–ª–µ–¥—É—é—â–µ–π, –ø–µ—Ä–≤–æ–π —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  71              	
  72 0001 BB000000 	        movl $0, %ebx   # counter = 0; —Å—á–µ—Ç—á–∏–∫ –¥–µ–ª–µ–Ω–∏–π
  72      00
  73 0006 A1000000 		movl n, %eax    # –≥–æ—Ç–æ–≤–∏–º –¥–µ–ª–µ–Ω–∏–µ  
  73      00
  74              	                        # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C
  75              	nextdigit:
  76 000b BA000000 	        movl  $0, %edx          # –µ—â–µ –≥–æ—Ç–æ–≤–∏–º 
  76      00
  77              	                                # –Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ –≤ C
  78              	# –∫–æ–º–∞–Ω–¥–∞ idivl –¥–µ–ª–∏—Ç 64-–±–∏—Ç–æ–≤–æ–µ —Ü–µ–ª–æ–µ –Ω–∞ —Å–≤–æ–π –æ–ø–µ—Ä–∞–Ω–¥
  79              	# –º–ª–∞–¥—à–∏–µ —Ä–∞–∑—Ä—è–¥—ã –¥–µ–ª–∏—Ç–µ–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ %eax, —Å—Ç–∞—Ä—à–∏–µ
  80              	# –≤ %edx. –ü–æ—Å–ª–µ –¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–Ω–æ–µ –≤ %eax, –æ—Å—Ç–∞—Ç–æ–∫ –≤ %edx
  81              	# –¢.–∫. –Ω–∞—à–µ —á–∏—Å–ª–æ 32-–±–∏—Ç–æ–≤–æ–µ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ª–µ–Ω–∏–µ–º –Ω—É–∂–Ω–æ
  82              	# –ø—Ä–∏—Å–≤–æ–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—É %edx –∑–Ω–∞—á–µ–Ω–∏–µ –Ω—É–ª—å (—Å–º. –ø—Ä–µ–¥—ã–¥—É—â—É—é 
  83              	# –∫–æ–º–∞–Ω–¥—É - movl  $0, %edx  )
  84              	
  85 0010 F73D0800 	        idivl ten      # –¥–µ–ª–∏–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã edx:eax –Ω–∞ 10
  85      0000
  86              	                       # —á–∞—Å—Ç–Ω–æ–µ –≤  eax, –æ—Å—Ç–∞—Ç–æ–∫ –≤ edx
  87              	        
  88 0016 43       	        incl %ebx       # ++counter; —Å—á–µ—Ç—á–∏–∫ –¥–µ–ª–µ–Ω–∏–π + 1
  89              	
  90              	#  –¥–≤–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—Å–ª–æ–≤–Ω–æ–º—É 
  91              	#  –æ–ø–µ—Ä–∞—Ç–æ—Ä—É if (quotient) goto nextdigit;
  92              	
  93 0017 83F800   	        cmpl $0, %eax    # —á–∞—Å—Ç–Ω–æ–µ < 0 ?
  94 001a 7FEF     	        jg   nextdigit   # –ù–ï–¢, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
  95              	
  96              	
  97              	/* –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –Ω–∞ –Ø–ö–¶–ü –í–°–ï–ì–î–ê –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–∞—Ä–æ–π –∫–
  98              	
  99              	cmp <–æ–ø–µ—Ä–∞–Ω–¥1>, <–æ–ø–µ—Ä–∞–Ω–¥2> - –≤—ã–ø. –≤—ã—á–∏—Ç–∞–Ω–∏–µ <–æ–ø–µ—Ä–∞–Ω–¥2>-<–æ–ø–µ—Ä–∞
 100              	                        - –æ—Ç—Ä–∞–∂–∞–µ—Ç –∑–Ω–∞–∫ –∏ –¥—Ä. —Å–≤–æ–π—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
 101              	                          –≤ –±–∏—Ç–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Ñ–ª–∞–≥–æ–≤.
 102              	
GAS LISTING task1.S 			page 3


 103              	 jcc <–æ–ø–µ—Ä–∞–Ω–¥> - j[ump on] c[ondition] c[ode] –ø—Ä–æ–≤–µ—Ä—è–µ—Ç
 104              	        —É—Å–ª–æ–≤–∏–µ –≤ –±–∏—Ç–∞—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Ñ–ª–∞–≥–æ–≤ –∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –ø—
 105              	        –≤—ã–ø–æ–ª–Ω—è–µ—Ç/–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥  –ø–æ –∞–¥—Ä–µ—Å—É <–æ–ø–µ—Ä–∞–Ω–
 106              	
 107              	 –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∫–æ–º–∞–Ω–¥–∞ jg   nextdigit { jg - jump if greater
 108              	- –ø–µ—Ä–µ–π—Ç–∏ –µ—Å–ª–∏ —Å—Ç—Ä–æ–≥–æ  –±–æ–ª—å—à–µ} –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–µ—Ç
 109              	nextdigit: –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –∫–æ–º–∞–Ω–¥–∞ cmpl $0, %eax —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∞ –≤
 110              	—Ä–µ–≥–∏—Å—Ç—Ä–µ —Ñ–ª–∞–≥–æ–≤ –±–∏—Ç—ã, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ä–µ–≥–∏
 111              	—Ç.–µ. —á–∞—Å—Ç–Ω–æ–µ, –°–¢–†–û–ì–û  –ë–û–õ–¨–®–ï –Ω—É–ª—è.
 112              	*/
 113              	
 114 001c 891D0400 	        movl %ebx, length  # length = counter; –î–ê,—Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç 
 114      0000
 115              	
 116              		Finish            # –∫–æ–Ω–µ—Ü —Ä–∞–±–æ—Ç—ã, 
 116 0022 BB000000 	>  movl $0,%ebx
 116      00
 116 0027 B8010000 	>  movl $1,%eax
 116      00
 116 002c CD80     	>  int $0x80
 117              	                          # –≤–æ–∑–≤—Ä–∞—Ç –≤ –û–°
 118              	                          # (–º–∞–∫—Ä–æ –∏–∑ —Ñ–∞–π–ª–∞ my-macro)
 119              	        
 120              	.end   # –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
GAS LISTING task1.S 			page 4


DEFINED SYMBOLS
             task1.S:57     .data:0000000000000000 n
             task1.S:58     .data:0000000000000004 length
             task1.S:59     .data:0000000000000008 ten
             task1.S:66     .text:0000000000000000 _start
             task1.S:75     .text:000000000000000b nextdigit

NO UNDEFINED SYMBOLS
